<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Olympics Pool 2024</title>
    <style>
        html, body {
            height: 100%; margin: 0; padding: 0;
            font-family: Arial, sans-serif; background-color: #f4f4f4;
            display: flex; flex-direction: column; text-align: center;
        }
        .correct { background-color: lightgreen; color: black; }
        .incorrect { background-color: lightcoral; color: black; }
        .not-entered { background-color: lightyellow; color: black; }
        .wrapper { flex: 1; display: flex; flex-direction: column; }
        header {
            background-color: #333; color: white; padding: 5px;
            display: flex; align-items: center;
        }
        header .brand {
            flex-grow: 1; font-size: 18px; text-align: left; padding-left: 10px;
        }
        header select {
            font-size: 16px; padding: 5px; border: none; border-radius: 5px;
            margin-left: auto; text-align: center;
        }
        .content { flex: 1; padding: 20px; display: none; }
        h1 { text-align: center; margin-bottom: 20px; padding-left: 10px; }
        .event-list {
            list-style-type: none; padding: 0; margin: 0;
            text-align: center;
        }
        .event-list li {
            background-color: #fff; padding: 10px; margin-bottom: 10px;
            border: 1px solid #ddd; border-radius: 5px; font-size: 16px;
            cursor: pointer; position: relative;
        }
        .event-list li.completed {
            color: red; position: relative;
        }
        .event-list li.completed .completed-text {
            font-weight: bold; text-decoration: none; display: block;
            margin-top: 5px; color: green;
        }
        .event-list li:hover { background-color: #f1f1f1; }
        .popup {
            display: none; position: fixed; left: 50%; top: 50%;
            transform: translate(-50%, -50%); background-color: #333;
            color: white; border-radius: 5px; padding: 20px;
            width: 300px; z-index: 1000; text-align: left;
            box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.5);
        }
        .event-list li:hover .popup { display: block; }
        footer {
            text-align: center; padding: 10px; background-color: #333;
            color: white;
        }
        #resultsContainer, #standingsContainer {
            display: flex; justify-content: center;
            align-items: flex-start; min-height: auto; padding-top: 20px;
        }
        #resultsContainer table, #standingsContainer table {
            border-collapse: collapse; width: 100%; max-width: 800px;
        }
        #resultsContainer th, #resultsContainer td,
        #standingsContainer th, #standingsContainer td {
            text-align: center; padding: 8px; border: 1px solid #ddd;
        }
        @media (max-width: 600px) {
            th, td { padding: 5px; font-size: 12px; }
            .race-times-container { flex-direction: column; align-items: center; }
            header select { font-size: 14px; padding: 4px; }
            h1 { font-size: 1.2em; text-align: center; }
            .clock { font-size: 22px; }
            .event-list li { padding: 8px; font-size: 14px; }
            #resultsContainer, #standingsContainer {
                height: auto; margin-top: 20px;
            }
        }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>
</head>
<body>
    <header>
        <div class="brand">SCRC Olympics Pool</div>
        <select id="pageSelector">
            <option value="#standings">Standings</option>
            <!--
            <option value="#home">Home</option>
            -->
            <!--
            <option value="#picks">Picks</option>
            -->
            <!--
            <option value="#results">Results</option>
            -->
        </select>
    </header>
    <div class="wrapper">
        <section id="home" class="content" style="display: block;">
            <h2>Welcome to the 2024 Summer Olympics Pool</h2>
            <div class="clock" id="clock"></div>
            <!-- Podium Display -->
    <div id="podium" style="display: flex; justify-content: center; align-items: flex-end; height: 200px; margin-top: 20px;">
        <div id="second" style="flex: 1; text-align: center;">
            <div style="background-color: silver; padding: 10px; border-radius: 5px;">2nd Place:</div>
            <div id="secondPlace" style="background-color: lightgray; padding: 10px; margin-top: 5px;"></div>
        </div>
        <div id="first" style="flex: 1; text-align: center;">
            <div style="background-color: gold; padding: 10px; border-radius: 5px;">1st Place</div>
            <div id="firstPlace" style="background-color: lightyellow; padding: 10px; margin-top: 5px;"></div>
        </div>
        <div id="third" style="flex: 1; text-align: center;">
            <div style="background-color: #cd7f32; padding: 10px; border-radius: 5px;">3rd Places</div>
            <div id="thirdPlace" style="background-color: #deb887; padding: 10px; margin-top: 5px;"></div>
        </div>
        
    </div>
            <!--
            <div class="race-times-container">
                <div class="race-times">
                    <h1>Race Schedule</h1>
                    <p>Click on the upcoming events for startlists!<br>Completed events are viewable on the 'Results' page!</p>
                    <ul class="event-list">
                        <li class="event" data-event-date="2024-08-03T15:30:00">Aug 3 - 100m (W) - 3:20pm</li>
                        <li class="event" data-event-date="2024-08-04T16:00:00">Aug 4 - 100m (M) - 3:50pm</li>
                        <li class="event" data-event-date="2024-08-06T15:50:00">Aug 6 - 200m (W) - 3:40pm</li>
                        <li class="event" data-event-date="2024-08-07T15:30:00">Aug 7 - 400m (M) - 3:20pm</li>
                        <li class="event" data-event-date="2024-08-08T14:40:00">Aug 8 - 200m (M) - 2:30pm</li>
                        <li class="event" data-event-date="2024-08-09T13:40:00">Aug 9 - 4x100m Relay (W) - 1:30pm</li>
                        <li class="event" data-event-date="2024-08-09T13:57:00">Aug 9 - 4x100m Relay (M) - 1:47pm</li>
                        <li class="event" data-event-date="2024-08-09T14:10:00">Aug 9 - 400m (W) - 2:00pm</li>
                    </ul>
                </div>
            </div>
            -->
        </section>
        <section id="picks" class="content">
            <h1>Participants' Picks</h1>
            <h3>Colour Codes</h3>
            <p>Yellow: event still to come</p>
            <p>Red: incorrect pick(s)</p>
            <p>Green: correct pick(s)</p>
            <div id="picksContainer"></div>
        </section>
        <section id="standings" class="content">
            <h1>Standings</h1>
            <h2>FINAL STANDINGS</h2>
            <div id="standingsContainer"></div>
            <p>Website will close at 11:59pm August 9th</p>
        </section>
        <section id="results" class="content">
            <h1>Event Results</h1>
            <ul style="list-style-type: none; padding: 0;">
                <li style="padding: 10px; border: 1px solid #ddd; margin-bottom: 10px; background-color: #fff; border-radius: 5px;">
                    <strong>100m (W)</strong><br>
                    <strong>WR: 10.49</strong><br><br>
                    Gold: Julien Alfred (LCA) - 10.72<br><br>
                    Silver: Sha'Carri Richardson (USA) - 10.87<br><br>
                    Bronze: Melissa Jefferson (USA) - 10.92<br><br><br>
                    4th: Daryll Neita (GBR) - 10.96<br><br>
                    5th: Twanisha Terry (USA) - 10.97<br><br>
                    6th: Mujinga Kambundji (SUI) - 10.99<br><br>
                    7th: Tia Clayton (JAM) - 11.04<br><br>
                    8th: Marie-Josee Ta Lou-Smith (CIV) - 13.84
                </li>
                <li style="padding: 10px; border: 1px solid #ddd; margin-bottom: 10px; background-color: #fff; border-radius: 5px;">
                    <strong>100m (M)</strong><br>
                    <strong>WR: 9.58</strong><br><br>
                    Gold: Noah Lyles (USA) - 9.79 (PF +0.005)<br><br>
                    Silver: Kishane Thompson (JAM) - 9.79<br><br>
                    Bronze: Fred Kerley (USA) - 9.81<br><br><br>
                    4th: Akani Simbine (RSA) - 9.82<br><br>
                    5th: Lamont Marcell Jacobs (ITA) - 9.85<br><br>
                    6th: Letsile Tebogo (BOT) - 9.86<br><br>
                    7th: Kenneth Bednarek (USA) - 9.88<br><br>
                    8th: Oblique Seville (JAM) - 9.91
                </li>
                <li style="padding: 10px; border: 1px solid #ddd; margin-bottom: 10px; background-color: #fff; border-radius: 5px;">
                    <strong>200m (F)</strong><br>
                    <strong>WR: 21.34</strong><br><br>
                    Gold: Gabrielle Thomas (USA) - 21.83<br><br>
                    Silver: Julien Alfred (LCA) - 22.08<br><br>
                    Bronze: Brittany Brown (USA) - 22.20<br><br><br>
                    4th: Dina Asher-Smith (GBR) - 22.22<br><br>
                    5th: Daryll Neita (GBR) - 22.23<br><br>
                    6th: Favour Ofili (NGR) - 22.24<br><br>
                    7th: Mckenzie Long (USA) - 22.42<br><br>
                    8th: Jessika Gbai (CIV) - 22.70
                </li>
                <li style="padding: 10px; border: 1px solid #ddd; margin-bottom: 10px; background-color: #fff; border-radius: 5px;">
                    <strong>400m (M)</strong><br>
                    <strong>WR: 43.03</strong><br><br>
                    Gold: Quincy Hall (USA) - 43.40<br><br>
                    Silver: Matthew Hudson-Smith (GBR) - 43.44<br><br>
                    Bronze: Muzala Samukonga (ZAM) - 43.74<br><br><br>
                    4th: Jereem Richards (TTO) - 43.78<br><br>
                    5th: Kirani James (GRN) - 43.87<br><br>
                    6th: Christopher Bailey (USA) - 44.58<br><br>
                    7th: Samuel Ogazi (NGR) - 44.73<br><br>
                    8th: Michael Norman (USA) - 45.62
                </li>
                <li style="padding: 10px; border: 1px solid #ddd; margin-bottom: 10px; background-color: #fff; border-radius: 5px;">
                    <strong>200m (M)</strong><br>
                    <strong>WR: 19.19</strong><br><br>
                    Gold: Letsile Tebogo (BOT) - 19.46<br><br>
                    Silver: Kenneth Bednarek (USA) - 19.62<br><br>
                    Bronze: Noah Lyles (USA) - 19.70<br><br><br>
                    4th: Erriyon Knighton (USA) - 19.99<br><br>
                    5th: Alexander Ogando (DOM) - 20.02<br><br>
                    6th: Tapiwanashe Makarawu (ZIM) - 20.10<br><br>
                    7th: Joseph Fahnbulleh (LBR) - 20.15<br><br>
                    8th: Makanakaishe Charamba (ZIM) - 20.53
                </li>
                <li style="padding: 10px; border: 1px solid #ddd; margin-bottom: 10px; background-color: #fff; border-radius: 5px;">
                    <strong>4x100m (W)</strong><br>
                    <strong>WR: 40.82</strong><br><br>
                    Gold: USA - 41.78<br><br>
                    Silver: GBR - 41.85<br><br>
                    Bronze: GER - 41.97<br><br><br>
                    4th: FRA - 42.23<br><br>
                    5th: JAM - 42.29<br><br>
                    6th: SWI - 42.67<br><br>
                    7th: CAN - 42.69<br><br>
                    8th: NED - 42.74
                </li>
                <li style="padding: 10px; border: 1px solid #ddd; margin-bottom: 10px; background-color: #fff; border-radius: 5px;">
                    <strong>4x100m (M)</strong><br>
                    <strong>WR: 36.84</strong><br><br>
                    Gold: CAN - 37.50<br><br>
                    Silver: RSA - 37.57<br><br>
                    Bronze: GBR - 37.61<br><br><br>
                    4th: ITA - 37.68<br><br>
                    5th: JAP - 37.78<br><br>
                    6th: FRA - 37.87<br><br>
                    7th: CHN - 38.06<br><br>
                    DSQ: USA
                </li>
                <li style="padding: 10px; border: 1px solid #ddd; margin-bottom: 10px; background-color: #fff; border-radius: 5px;">
                    <strong>400m (W)</strong><br>
                    <strong>WR: 47.60</strong><br><br>
                    Gold: Marileidy Paulino - 48.17 (OR)<br><br>
                    Silver: Salwa Eid Naser - 48.53<br><br>
                    Bronze: Natalia Kaczmarek - 48.98<br><br><br>
                    4th: Rhasidat Adeleke - 49.28<br><br>
                    5th: Amber Anning - 49.29<br><br>
                    6th: Alexis Holmes - 49.77<br><br>
                    7th: Sada Williams - 49.83<br><br>
                    8th: Henriette Jaeger - 49.96
                </li>
            </ul>
        </section>
    </div>
    <footer>&copy; PulseDynamics (v1.2.0)</footer>
    <script>
        document.getElementById('pageSelector').addEventListener('change', function() {
            const selectedPage = this.value;
            document.querySelectorAll('.content').forEach(section => section.style.display = 'none');
            document.querySelector(selectedPage).style.display = 'block';
            if (selectedPage === '#picks') loadPicks();
            else if (selectedPage === '#standings') calculateStandings();
            else if (selectedPage === '#results') loadResults();
        });

        async function loadPicks() {
            const response = await fetch('SCRC_2024_Olympics_Pool_PICKS.xlsx');
            const data = await response.arrayBuffer();
            const workbook = XLSX.read(data, { type: 'array' });
            const picksContainer = document.getElementById('picksContainer');
            picksContainer.innerHTML = '';
            const resultsResponse = await fetch('SCRC_2024_Olympics_Pool_Results.xlsx');
            const resultsData = await resultsResponse.arrayBuffer();
            const resultsWorkbook = XLSX.read(resultsData, { type: 'array' });
            const resultsSheet = resultsWorkbook.Sheets[resultsWorkbook.SheetNames[0]];
            const results = XLSX.utils.sheet_to_json(resultsSheet);

            workbook.SheetNames.forEach(sheetName => {
                if (sheetName === 'ALL_ENTRIES') return;
                const sheet = workbook.Sheets[sheetName];
                const json = XLSX.utils.sheet_to_json(sheet);
                const table = document.createElement('table');
                table.border = 1; table.style.margin = 'auto';
                const header = table.createTHead();
                const headerRow = header.insertRow();
                ['Event', 'Winner', '2nd Place', '3rd Place'].forEach(text => {
                    const th = document.createElement('th');
                    th.textContent = text;
                    headerRow.appendChild(th);
                });
                const tbody = table.createTBody();
                json.forEach(row => {
                    const tr = tbody.insertRow();
                    const result = results.find(r => r['Event'] === row['Event']);
                    ['Event', 'Winner', '2nd Place', '3rd Place'].forEach((key, index) => {
                        const td = tr.insertCell();
                        td.textContent = row[key] || '("")';
                        if (index > 0) {
                            if (result && result[key]) {
                                if (result[key] === row[key]) td.classList.add('correct');
                                else td.classList.add('incorrect');
                            } else td.classList.add('not-entered');
                        }
                    });
                });
                const title = document.createElement('h2');
                title.textContent = sheetName;
                picksContainer.appendChild(title);
                picksContainer.appendChild(table);
            });
        }

        async function calculateStandings() {
            const response = await fetch('SCRC_2024_Olympics_Pool_Results.xlsx');
            const data = await response.arrayBuffer();
            const resultsWorkbook = XLSX.read(data, { type: 'array' });
            const resultsSheet = resultsWorkbook.Sheets[resultsWorkbook.SheetNames[0]];
            const results = XLSX.utils.sheet_to_json(resultsSheet);
            const picksResponse = await fetch('SCRC_2024_Olympics_Pool_PICKS.xlsx');
            const picksData = await picksResponse.arrayBuffer();
            const picksWorkbook = XLSX.read(picksData, { type: 'array' });
            const standings = {};
            picksWorkbook.SheetNames.forEach(sheetName => {
                if (sheetName === 'ALL_ENTRIES') return;
                const sheet = picksWorkbook.Sheets[sheetName];
                const picks = XLSX.utils.sheet_to_json(sheet);
                let totalPoints = 0;
                picks.forEach(pick => {
                    if (pick['Event'] && pick['Winner'] && pick['2nd Place'] && pick['3rd Place']) {
                        const result = results.find(r => r['Event'] === pick['Event']);
                        if (result) {
                            let points = 0;
                            if (result['Winner'] === pick['Winner']) points += 10;
                            if (result['2nd Place'] === pick['2nd Place']) points += 6;
                            if (result['3rd Place'] === pick['3rd Place']) points += 4;
                            if (points === 20) points += 5;
                            totalPoints += points;
                        }
                    }
                });
                standings[sheetName] = totalPoints;
            });
            displayStandings(standings);
        }

        function displayStandings(standings) {
    const standingsContainer = document.getElementById('standingsContainer');
    standingsContainer.innerHTML = '';
    const sortedStandings = Object.entries(standings).sort(([, pointsA], [, pointsB]) => pointsB - pointsA);
    const table = document.createElement('table');
    table.className = 'standings-table'; table.border = 1;
    table.style.margin = 'auto';
    const header = table.createTHead();
    const headerRow = header.insertRow();
    ['Participant', 'Current Points'].forEach(text => {
        const th = document.createElement('th');
        th.textContent = text;
        headerRow.appendChild(th);
    });
    const tbody = table.createTBody();
    sortedStandings.forEach(([participant, points]) => {
        const tr = tbody.insertRow();
        const nameCell = tr.insertCell();
        const pointsCell = tr.insertCell();
        nameCell.textContent = participant;
        pointsCell.textContent = points;
    });
    standingsContainer.appendChild(table);

    // Update Podium Display
    if (sortedStandings.length > 0) {
        document.getElementById('firstPlace').textContent = sortedStandings[0][0];
        if (sortedStandings.length > 1) {
            document.getElementById('secondPlace').textContent = sortedStandings[1][0];
        }
        if (sortedStandings.length > 2) {
            document.getElementById('thirdPlace').textContent = sortedStandings[2][0];
        }
    }
}


        function updateClock() {
            const now = new Date();
            const year = now.getFullYear();
            const month = String(now.getMonth() + 1).padStart(2, '0');
            const day = String(now.getDate()).padStart(2, '0');
            let hours = now.getHours();
            const minutes = String(now.getMinutes()).padStart(2, '0');
            const seconds = String(now.getSeconds()).padStart(2, '0');
            const ampm = hours >= 12 ? 'PM' : 'AM';
            hours = hours % 12;
            hours = hours ? hours : 12;
            const formattedTime = `${hours}:${minutes}:${seconds} ${ampm} EDT`;
            const formattedDate = `${year}-${month}-${day}`;
            document.getElementById('clock').textContent = `${formattedDate} ${formattedTime}`;
            checkEventCompletion(now);
        }
        setInterval(updateClock, 1000);

        function checkEventCompletion(currentTime) {
            const eventItems = document.querySelectorAll('.event-list li.event');
            eventItems.forEach(item => {
                const eventDate = new Date(item.getAttribute('data-event-date'));
                if (currentTime >= eventDate && !item.classList.contains('completed')) {
                    item.classList.add('completed');
                    const eventText = item.textContent;
                    item.innerHTML = `<span style="text-decoration: line-through;">${eventText}</span><br><span class="completed-text">COMPLETED</span>`;
                }
            });
        }

        document.querySelectorAll('.event-list li').forEach(item => {
            item.addEventListener('click', function() {
                const popup = this.querySelector('.popup');
                if (popup) {
                    popup.style.display = popup.style.display === 'block' ? 'none' : 'block';
                }
            });
            document.addEventListener('click', function(event) {
                if (!item.contains(event.target)) {
                    const popup = item.querySelector('.popup');
                    if (popup) {
                        popup.style.display = 'none';
                    }
                }
            });
        });
    </script>
</body>
</html>
